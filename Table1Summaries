drop table if exists devo.summariesGV;
create table devo.summariesGV as (
select distinct c.deceased, c.contactid, c.accountid, c.accountname, c.city, c.state, c.zip_5, c.zip_4, targetscore, targetgiftrange, principalsolution, c.type, c.recordtype_hoh, c.ranking, c.prospectranking, c.relationshipmanager, c.staffcontact, 
  case when c.zip_5 in ('10453', '10457', '10460', '11412', '11423', '11432', '11433', '11434', '11435', '11436', '11101', '11102', '11103', '11104', '11105', '11106', '11374', '11375', '11379', '11385', '11691', '11692', '11693', '11694', '11695', '11697', '11004', '11005', '11411', '11413', '11422', '11426', '11427', '11428', '11429', '11414', '11415', '11416', '11417', '11418', '11419', '11420', '11421', '11368', '11369', '11370', '11372', '11373', '11377', '11378', '10302', '10303', '10310', '10306', '10307', '10308', '10309', '10312', '10301', '10304', '10305', '10314', '11365', '11366', '11367', '11204', '11218', '11219', '11230', '11209', '11214', '11228', '11212', '11213', '11216', '11233', '11238', '10461', '10462', '10464', '10465', '10472', '10473', '10466', '10469', '10470', '10475', '10463', '10471', '10454', '10455', '10459', '10474', '10451', '10452', '10456', '10458', '10467', '10468', '11223', '11224', '11229', '11235', '11234', '11236', '11239', '11201', '11205', '11215', '11217', '11231', '11203', '11210', '11225', '11226', '11207', '11208', '11211', '11222', '11220', '11232', '11206', '11221', '11237', '10026', '10027', '10030', '10037', '10039', '10001', '10011', '10018', '10019', '10020', '10036', '10029', '10035', '10010', '10016', '10017', '10022', '10012', '10013', '10014', '10004', '10005', '10006', '10007', '10038', '10280', '10002', '10003', '10009', '10021', '10028', '10044', '10065', '10075', '10128', '10023', '10024', '10025', '10031', '10032', '10033', '10034', '10040', '11361', '11362', '11363', '11364', '11354', '11355', '11356', '11357', '11358', '11359', '11360') then 'NYC_Primary' 
 when c.zip_5 in ('8863', '7095', '7065', '8861', '7001', '7083', '7204', '8862', '7203', '7077', '7036', '7064', '7051', '7008', '7111', '7205', '7106', '7208', '7018', '7042', '7202', '7207', '7112', '7017', '10950', '7019', '7028', '7108', '7043', '7508', '7103', '7502', '10914', '10949', '7107', '7003', '12586', '7206', '7538', '7522', '7201', '7501', '7175', '7505', '7102', '10311', '7101', '7184', '7188', '7189', '7191', '7192', '7193', '7195', '7198', '7199', '7509', '7510', '7511', '7533', '7543', '7544', '12589', '7013', '10992', '7104', '7114', '7481', '7015', '7109', '7012', '12575', '7524', '7110', '7506', '7507', '10974', '10910', '7495', '7503', '7029', '10926', '7513', '7105', '7446', '7099', '7504', '7011', '7514', '7432', '7014', '7401', '10975', '7055', '7031', '7452', '7463', '10313', '7032', '7410', '7407', '7451', '10917', '7071', '7450', '7026', '12419', '12577', '7057', '7070', '7002', '10901', '12548', '10982', '7423', '7458', '10930', '7663', '7073', '12561', '7075', '12443', '10970', '10952', '7644', '7395', '7662', '10953', '7303', '7399', '7097', '12568', '7653', '7305', '7604', '7308', '7306', '12472', '7652', '7699', '12515', '7072', '12486', '7094', '7676', '7304', '7608', '12401', '12553', '7607', '7311', '7074', '12584', '7096', '7677', '7307', '7606', '10928', '7642', '10977', '7601', '7643', '7645', '7656', '7602', '7302', '12550', '12471', '12411', '7661', '7310', '10980', '7087', '7603', '7030', '11252', '7630', '7649', '7047', '7660', '12518', '10281', '7646', '12402', '7086', '10984', '10045', '12475', '10282', '12555', '10965', '7666', '7657', '10954', '12551', '12552', '10271', '10041', '12520', '10279', '7093', '7675', '10270', '10043', '10080', '10081', '10087', '10101', '10102', '10108', '10109', '10113', '10114', '10116', '10117', '10124', '10125', '10126', '10129', '10130', '10131', '10132', '10133', '10138', '10150', '10156', '10157', '10159', '10160', '10163', '10164', '10179', '10185', '10203', '10211', '10212', '10213', '10256', '10258', '10259', '10260', '10261', '10265', '10268', '10269', '10272', '10273', '10274', '10275', '10276', '10277', '10285', '10286', '10008', '12528', '10278', '10923', '7022', '10911', '7641', '10090', '7621', '12487', '12542', '7650', '10249', '10922', '11202', '10121', '10242', '10199', '7628', '10119', '12449', '11249', '10060', '11241', '7605', '10956', '10118', '11243', '10110', '10069', '12417', '10123', '11242', '11245', '10122', '11256', '10986', '7010', '12547', '10120', '10168', '10175', '10106', '12493', '10107', '7640', '10112', '10173', '12466', '10178', '10176', '10165', '10105', '10103', '10174', '10111', '10104', '12429', '10169', '10170', '10177', '10158', '10166', '10151', '10167', '10172', '10055', '10171', '7020', '10153', '10154', '7631', '10996', '10152', '11251', '10994', '7024', '10155', '7624', '12512', '10993', '10115', '10962', '10596', '12511', '10913', '10997', '11109', '7626', '7627', '10927', '7670', '12574', '10162', '11120', '10983', '12508', '10511', '7648', '7632', '7647', '10548', '12527', '10521', '10989', '12537', '10920', '10524', '10566', '12602', '10964', '11247', '12507', '7620', '10960', '10968', '10976', '10516', '10567', '12504', '10702', '12601', '12524', '10705', '12604', '12590', '12538', '10537', '10701', '10703', '10520', '10503', '11371', '10706', '10522', '12572', '12580', '10517', '10545', '10704', '12603', '10533', '10547', '10591', '10710', '10510', '10502', '10551', '10562', '10550', '10708', '11351', '11424', '10552', '11380', '10707', '11352', '10588', '10579', '12571', '10553', '10523', '11381', '11386', '10530', '10607', '10709', '10532', '11405', '11425', '11439', '11451', '11499', '10803', '11431', '10535', '10546', '12578', '10583', '12569', '10570', '10598', '11430', '10804', '10595', '10801', '10802', '10805', '12533', '10603', '10606', '10514', '10594', '11690', '10601', '12510', '10602', '10610', '10542', '10527', '12514', '10501', '10538', '11096', '10541', '10505', '10605', '11022', '11024', '10587', '10543', '11023', '10604', '11509', '11027', '10540', '12582', '11516', '10512', '11021', '12540', '10528', '11026', '10549', '10577', '11559', '11020', '11581', '11598', '11582', '10504', '11001', '11002', '11003', '11580', '12585', '11042', '11051', '11052', '11053', '11054', '11055', '11557', '11050', '12581', '12506', '10507', '10580', '10536', '10589', '11030', '12570', '11040', '10573', '12545', '10578', '12531', '11010', '11563', '11565', '11518', '10519', '6831', '11558', '11507', '11552', '11576', '11531', '10526', '11579', '11596', '11547', '11561', '11501', '11570', '11572', '11571', '11577', '11530', '10506', '6836', '11548', '6830', '11542', '11550', '11551', '11599', '11514', '10560', '11510', '12522', '11549', '10518', '10509', '10597', '11555', '11556', '11569', '11553', '11560', '11545', '11568', '12564', '6807', '12563', '11575', '11520', '6878', '11590', '12501', '6903', '12594', '6870', '10576', '12592', '11765', '11554', '11709', '6910', '11566', '6902', '12546', '11732', '11753', '6905', '11853', '10590', '6904', '6911', '6912', '6913', '6914', '6921', '6926', '6927', '6901', '11710', '11771', '11802', '11815', '11801', '6906', '6907', '11756', '11793', '11791', '11775', '6840', '6879', '11773', '6877', '11783', '11714', '6820', '6811', '11803', '6810', '11797', '11758', '6813', '6814', '6816', '6817', '11804', '11724', '11762', '11737', '11760', '6897', '6850', '6853', '6829', '11735', '6854', '11702', '11743', '11701', '6852', '6856', '6857', '6858', '6860', '6851', '11747', '6855', '11726', '6896', '6875', '6883', '11757', '11721', '11798', '11704', '11746', '11740', '6881', '6888', '6889', '6876', '6880', '11768', '11707', '11703', '11729', '6838', '11731', '6612', '11795', '6890', '6824', '11725', '11718', '11717', '6828', '11754', '6825', '6605', '11751', '6606', '11788', '6604', '11787', '11706', '6601', '6673', '6699', '11722', '6602', '11780', '6608', '11752', '11749', '6610', '11730', '6607', '11739', '11770', '11767', '6615', '11769', '11790', '11716', '11794', '11755', '11779', '11733', '11796', '11720', '11741', '11782', '11777', '11705', '6460', '11742', '501', '544', '11776', '11738', '11784', '11715', '11766', '11727', '11764', '11763', '11789', '11953', '11713', '11778', '11980', '11719', '11772', '11961', '11786', '11973', '11967', '11950', '11951', '11792', '11955', '11934', '11949', '11940', '11933', '11941', '11960', '11972', '11977', '11901', '11931', '11978', '11959', '11942', '11947', '11970', '11948', '11952', '11946', '11935', '11958', '11956', '11971', '11968', '11969', '11944', '11976', '11939', '11965', '11963', '11964', '11932', '11962', '11975', '11957', '11937', '11930', '11954') then 'NYC_Secondary' 
when c.state in ('MD', 'VA', 'DC') then 'MidAtlantic_Primary'
when c.state in ('DE', 'PA', 'NJ') then 'MidAtlantic_Secondary'
when c.state in ('IL', 'OH', 'WI') then 'MidWest_Primary'
when c.state in ('MI', 'MN', 'MO', 'IA', 'KY') then 'MidWest_Secondary'
when c.state in ('CO', 'TX') then 'Mountain_Primary'
when c.state in ('NV', 'NM', 'AZ') then 'Mountain_Secondary'
when c.state in ('CT', 'MA', 'ME') then 'NewEngland_Primary'
when c.state in ('NH', 'VT', 'RI') then 'NewEngland_Secondary'
when c.state in ('FL', 'GA', 'NC') then 'Southeast_Primary'
when c.state in ('SC', 'TN') then 'Southeast_Secondary'
when c.state in ('WA', 'OR') then 'PNW_Primary'
when c.state in ('MT', 'UT', 'ID') then 'PNW_Secondary'
when c.zip_5 in ('93435', '93428', '93430', '93443', '93412', '93402', '93442', '93405', '93424', '93465', '93422', '93409', '93423', '93408', '93410', '93407', '93449', '93403', '93406', '93447', '93448', '93433', '93401', '93483', '93434', '93445', '93475', '93421', '93437', '93429', '93444', '93432', '93458', '93438', '93457', '93456', '93455', '93436', '93420', '93440', '93454', '93427', '93464', '93463', '93453', '93441', '93117', '93460', '93254', '93107', '93106', '93116', '93118', '93199', '93111', '93105', '93110', '93109', '93102', '93120', '93121', '93130', '93140', '93150', '93160', '93190', '93101', '93103', '93067', '93108', '93014', '93013', '93001', '93252', '93022', '93002', '93005', '93006', '93007', '93009', '93023', '93024', '93035', '93003', '93222', '93043', '93044', '93036', '93030', '93031', '93032', '93034', '93004', '93041', '93225', '93033', '93042', '93060', '93010', '93061', '93066', '93011', '93012', '91320', '93243', '93016', '91319', '91360', '93020', '91361', '93021', '93015', '91358', '91359', '91362', '93062', '90265', '93065', '91376', '91377', '91301', '93094', '93040', '93099', '93064', '90263', '93063', '91307', '91302', '91372', '90264', '91384', '91304', '91381', '91367', '90290', '91355', '91365', '91303', '91313', '91364', '91305', '91308', '91309', '91311', '91371', '91310', '91306', '91396', '91383', '91326', '91380', '91324', '91354', '91357', '90272', '91356', '91335', '91385', '91327', '91328', '91329', '91337', '93532', '91322', '91382', '91330', '91394', '91325', '91316', '91344', '91350', '90402', '91416', '91426', '91436', '90401', '91406', '90406', '90407', '90408', '90409', '90410', '90411', '90403', '90049', '93536', '91343', '90404', '90405', '91346', '91395', '91403', '90291', '91495', '91321', '91351', '91411', '90294', '91345', '90077', '90073', '91386', '91412', '91392', '91413', '90704', '91404', '91407', '91408', '91409', '91410', '91470', '91482', '91496', '91499', '90084', '90292', '90296', '91405', '91402', '90025', '90095', '90293', '90295', '91341', '90024', '91340', '90066', '91423', '91401', '90064', '91333', '91331', '90094', '90210', '90067', '91387', '90245', '90212', '90045', '91390', '90267', '91607', '90266', '90230', '90034', '90209', '90213', '90254', '90231', '90233', '91605', '90232', '91604', '91606', '90277', '90035', '90211', '90069', '91603', '91609', '91610', '91611', '91612', '91614', '91615', '91616', '91617', '91618', '90261', '90048', '90056', '90278', '90274', '91601', '91353', '90046', '91602', '90301', '90304', '90275', '90016', '90260', '90302', '90503', '91608', '90306', '90307', '90308', '90309', '90310', '90312', '90505', '90251', '90311', '90036', '91505', '90008', '90250', '91352', '90507', '90508', '90509', '90510', '90019', '90043', '91522', '90068', '91523', '90506', '90504', '90305', '90303', '90028', '90038', '91504', '91521', '91506', '90717', '90249', '90018', '90732', '91040', '90501', '90010', '90020', '90005', '90004', '90062', '91502', '90047', '91503', '91507', '91508', '91510', '91526', '91501', '91342', '91041', '90247', '90710', '90029', '90006', '90502', '90044', '91201', '90733', '90734', '90027', '90037', '90089', '91043', '90248', '90007', '91393', '90749', '90057', '90731', '90061', '90003', '90070', '90015', '91202', '91203', '90017', '90026', '90748', '91204', '90744', '91207', '90745', '90011', '90747', '90746', '91210', '91334', '90822', '90071', '90039', '91209', '91221', '91222', '91224', '91225', '91226', '90014', '91208', '90099', '90001', '90189', '90002', '91214', '90090', '90059', '93551', '90030', '90050', '90051', '90052', '90053', '90054', '90055', '90060', '90072', '90074', '90075', '90076', '90078', '90080', '90081', '90082', '90083', '90086', '90087', '90088', '90093', '90009', '90013', '91205', '90220', '90079', '90012', '90021', '91046', '90222', '91042', '91020', '90065', '91021', '90810', '90223', '90224', '91206', '90895', '90031', '90802', '90255', '90058', '90033', '90096', '90041', '90813', '90262', '91012', '90221', '90023', '90042', '90280', '90801', '90809', '90832', '90842', '90844', '90846', '90847', '90848', '90853', '90899', '90063', '90270', '93510', '90805', '90032', '90807', '90806', '91103', '91105', '90201', '90755', '90723', '90833', '90835', '91123', '91030', '90831', '90834', '90091', '90040', '90202', '90022', '91031', '91754', '90712', '90804', '91803', '91102', '91109', '91110', '91114', '91115', '91116', '91117', '91118', '91121', '91124', '91125', '91126', '91129', '91182', '91184', '91185', '91188', '91189', '90814', '90242', '91101', '93539', '91001', '93584', '93586', '91801', '90711', '90714', '91804', '90239', '91003', '90803', '91106', '90706', '91802', '91896', '91899', '90241', '91714', '91715', '91716', '91104', '91756', '91199', '90240', '90707', '93590', '93599', '90840', '91108', '90815', '91755', '90808', '90713', '90640', '91778', '91011', '90661', '90662', '91776', '91775', '91107', '90660', '90743', '90671', '90702', '91770', '90651', '90652', '90701', '90715', '90740', '90650', '90716', '91771', '91772', '90721', '90742', '90610', '90703', '91023', '90606', '90720', '93550', '90670', '92649', '91733', '91025', '91780', '91007', '91024', '91731', '90623', '90630', '91066', '91077', '91006', '90607', '90608', '90609', '90602', '92845', '91734', '91735', '90601', '93552', '92648', '90639', '90605', '91732', '90637', '90604', '90620', '90638', '92647', '92684', '91017', '92615', '90680', '90622', '90624', '91746', '90603', '92605', '90621', '92683', '92685', '92655', '91745', '92841', '92804', '91009', '91016', '92844', '91008', '91706', '92646', '92833', '92801', '91010', '90631', '92728', '92809', '91747', '91749', '92708', '90632', '90633', '91790', '91793', '92842', '92846', '91744', '93543', '92663', '92658', '92659', '92840', '92832', '92843', '92628', '92627', '92802', '92899', '92704', '92803', '92812', '92814', '92815', '92816', '92817', '92825', '92850', '93563', '91702', '92805', '92703', '91722', '92835', '92626', '91748', '92661', '92834', '92836', '92837', '92838', '91792', '92831', '92662', '92822', '91723', '93553', '91791', '92821', '92868', '92706', '92660', '92707', '92702', '92711', '92712', '92806', '92799', '92625', '91788', '92871', '92735', '92701', '91789', '92856', '92857', '92859', '92863', '92864', '91724', '92870', '92865', '91740', '92866', '92617', '92697', '91741', '92657', '92811', '92614', '92698', '92616', '92619', '92623', '92612', '92780', '92867', '91765', '92606', '92781', '92705', '91773', '92861', '92885', '92823', '92782', '92603', '91768', '92604', '92807', '92886', '92869', '92607', '92652', '92654', '92651', '91766', '93544', '92620', '92650', '91750', '91769', '92602', '92808', '91767', '92618', '92637', '92656', '92887', '91709', '91711', '92653', '92609', '92677', '92629', '91763', '92862', '92630', '92690', '91710', '92691', '92610', '92624', '91786', '92693', '91784', '91758', '91785', '91708', '92692', '92694', '91762', '92372', '92673', '92882', '92880', '92674', '92688', '92676', '91729', '91701', '92678', '91743', '91761', '91764', '91737', '91730', '92397', '92329', '92877', '92878', '92860', '91759', '92679', '92675', '92371', '92358', '92879', '91752', '92672', '91739', '92505', '92883', '92881', '92337', '92335', '92336', '92509', '92331', '92503', '92334', '92055', '92504', '92344', '92530', '92502', '92513', '92514', '92516', '92517', '92519', '92522', '92316', '92377', '92376', '92049', '92051', '92052', '92501', '92054', '92058', '92506', '92018', '92521', '92531', '92411', '92570', '92322', '92507', '92508', '92313', '92008', '92532', '92068', '92403', '92405', '92407', '92402', '92406', '92413', '92415', '92418', '92423', '92427', '92011', '92028', '92410', '92401', '92023', '92056', '92325', '92057', '92010', '92404', '92518', '92038', '92039', '92092', '92562', '92007', '92324', '92013', '92350', '92357', '92595', '92557', '92408', '92093', '92075', '92587', '92169', '92354', '92088', '92024', '92553', '92037', '92081', '92083', '92152', '92009', '92085', '92107', '92318', '92590', '92109', '92106', '92378', '92391', '92572', '92599', '92551', '92369', '92014', '92564', '92317', '92084', '92135', '92122', '92121', '92003', '92091', '92110', '92130', '92140', '92586', '92117', '92067', '92571', '92352', '92584', '92178', '92585', '92375', '92101', '92078', '92374', '92103', '92346', '92079', '92111', '92118', '92321', '92155', '92147', '92069', '92096', '92132', '92112', '92137', '92138', '92142', '92143', '92149', '92150', '92158', '92159', '92160', '92161', '92163', '92165', '92166', '92167', '92168', '92170', '92171', '92172', '92174', '92175', '92176', '92177', '92179', '92186', '92187', '92190', '92191', '92192', '92193', '92195', '92196', '92197', '92373', '92589', '92593', '92108', '92134', '92126', '92563', '92123', '92029', '92382', '92116', '92104', '92129', '92385', '92127', '92136', '92145', '92113', '92102', '91932', '91933', '92556', '92555', '92026', '92567', '92548', '92591', '92554', '92552', '91951', '92124', '92105', '91950', '92030', '92033', '92046', '92131', '91909', '91912', '92153', '92199', '92120', '92128', '92198', '92182', '92359', '92115', '92596', '92545', '91921', '91910', '92114', '92173', '92320', '91911', '92139', '91945', '92074', '92119', '91946', '91908', '91943', '91944', '92582', '91942', '92064', '92399', '91902', '92071', '92592', '92025', '92223', '91941', '91976', '91979', '91977', '91913', '92154', '92027', '92082', '92543', '92059', '92072', '92546', '92020', '91915', '91914', '92022', '92581', '91978', '92583', '92061', '92544', '92019', '92021', '92040', '92065', '92060', '92536', '91935', '92549', '91903', '92070', '91917', '91901', '92539', '91980', '92086', '91916', '91987', '91963', '91931', '92066', '91906', '91962', '91948', '92036') then 'CASouth_Primary'
when c.zip_5 in ('93920', '93927', '93928', '93932', '93452', '93426', '93930', '93954', '93450', '93446', '93451', '93210', '93608', '93461', '93627', '93624', '93204', '93234', '93607', '93656', '93706', '93652', '93609', '93245', '93239', '93266', '93249', '93246', '93725', '93202', '93242', '93625', '93232', '93662', '93230', '93251', '93224', '93616', '93212', '93648', '93282', '93631', '93201', '93673', '93206', '93268', '93227', '93280', '93618', '93277', '93291', '93654', '93274', '93275', '93666', '93272', '93256', '93219', '93263', '93290', '93276', '93278', '93279', '93615', '93216', '93646', '93670', '93314', '93235', '93292', '93647', '93223', '93311', '93215', '93250', '93261', '93312', '93267', '93247', '93309', '93221', '93270', '93313', '93286', '93301', '93304', '93302', '93303', '93380', '93383', '93384', '93385', '93386', '93387', '93388', '93389', '93258', '93390', '93218', '93305', '93244', '93308', '93241', '93307', '93603', '93237', '93257', '93220', '93306', '93207', '93287', '93203', '93271', '93262', '93260', '93226', '93265', '93285', '93531', '93208', '93205', '93560', '93561', '93581', '93518', '93240', '93238', '93283', '93502', '93501', '93534', '93255', '93504', '93545', '93527', '93530', '93542', '93535', '93523', '93549', '93519', '93505', '93591', '93554', '93528', '93516', '93556', '93596', '93558', '93524', '93522', '92301', '93555', '92392', '93562', '93592', '92342', '92345', '92394', '92347', '92340', '92395', '92393', '92368', '92308', '92307', '92328', '92341', '92311', '92398', '92312', '92333', '92315', '92314', '92356', '92305', '92327', '92339', '92220', '92386', '92230', '92365', '92310', '92282', '92256', '92262', '92268', '92258', '92263', '92240', '92264', '92285', '92284', '92561', '92235', '92234', '92286', '92270', '92384', '92260', '92255', '92261', '92276', '92338', '92004', '92210', '92241', '92211', '92247', '92248', '91905', '92252', '92253', '92203', '92201', '92202', '91934', '92309', '92236', '92278', '92259', '92274', '92275', '92254', '92304', '92389', '92277', '92257', '92273', '92281', '92251', '92243', '92366', '92244', '92233', '92231', '92232', '92227', '92249', '92239', '92364', '92323', '92250', '92332', '92283', '92280', '92266', '92363', '92225', '92226', '92222', '92242', '92267') then 'CASouth_Secondary'
when c.zip_5 in ('94929', '94937', '94971', '94940', '94956', '94950', '94938', '94946', '94924', '94933', '94963', '94970', '94930', '94973', '94947', '94978', '94960', '94948', '94998', '94941', '94979', '94945', '94957', '94949', '94942', '94904', '94903', '94977', '94965', '94914', '94915', '94912', '94913', '94976', '94939', '94925', '94037', '94901', '94121', '94038', '94974', '94964', '94132', '94966', '94116', '94122', '94044', '94017', '94015', '94018', '94129', '94920', '94118', '94016', '94127', '94112', '94131', '94117', '94114', '94014', '94115', '94123', '94066', '94080', '94109', '94119', '94120', '94125', '94126', '94137', '94139', '94140', '94141', '94142', '94143', '94144', '94145', '94146', '94147', '94151', '94159', '94160', '94161', '94163', '94164', '94172', '94177', '94188', '94005', '94102', '94110', '94133', '94103', '94019', '94134', '94108', '94083', '94030', '94104', '94111', '94105', '94107', '94158', '94807', '94124', '94801', '94128', '94010', '94130', '94011', '94074', '94850', '94802', '94808', '94804', '94806', '94060', '94402', '94592', '94497', '94401', '94805', '94710', '94403', '94607', '94002', '94062', '94706', '94820', '94608', '94530', '94702', '94662', '94803', '94564', '94707', '94501', '94703', '94701', '94712', '94020', '94604', '94614', '94620', '94622', '94623', '94624', '94649', '94659', '94660', '94661', '94666', '94404', '94617', '94070', '94612', '94615', '94021', '94709', '94609', '94708', '94547', '94720', '94590', '94589', '94065', '94704', '94606', '94502', '94705', '94572', '94061', '94610', '94618', '94064', '94503', '94525', '94611', '95017', '94601', '94028', '94621', '94602', '94027', '94063', '94591', '94563', '94516', '94569', '94025', '94613', '94026', '94603', '94619', '94305', '94304', '94577', '95060', '94579', '95006', '94605', '94553', '94301', '94022', '94302', '94309', '94580', '94306', '94570', '94575', '94578', '94510', '94303', '94546', '94545', '94023', '94024', '94549', '94556', '95007', '95005', '95014', '94040', '94541', '94039', '94042', '94540', '94543', '94557', '94523', '94555', '94043', '94041', '94597', '94595', '95064', '95018', '95041', '94035', '95070', '94560', '94544', '94587', '94520', '94596', '94088', '94542', '95015', '94087', '94522', '94524', '94527', '94529', '95061', '95063', '95067', '94086', '94518', '95071', '94089', '94085', '95066', '95129', '94583', '94526', '94598', '95002', '94507', '95030', '95062', '94537', '94538', '95044', '95051', '94536', '94552', '95065', '95033', '95026', '95130', '95031', '95117', '94528', '95054', '95052', '95055', '95056', '95008', '95010', '95050', '95009', '95011', '95134', '93953', '95073', '95053', '95128', '95032', '95124', '93950', '93921', '93922', '93924', '95126', '94568', '94582', '94539', '95110', '95036', '93944', '95131', '94588', '95001', '95125', '93942', '95103', '95106', '95108', '95109', '95115', '95150', '95151', '95152', '95153', '95154', '95155', '95156', '95157', '95158', '95159', '95160', '95161', '95164', '95170', '95172', '95173', '95190', '95191', '95193', '95194', '95196', '95113', '95118', '95101', '94586', '95112', '95192', '95003', '93943', '95133', '95116', '95136', '95122', '93940', '95120', '95111', '95132', '95123', '93955', '95042', '95035', '95121', '95119', '95019', '93933', '95039', '95139', '95077', '95013', '95141', '95012', '95138', '95076', '93902', '93912', '93915', '95038', '93907', '93901', '93962', '95037', '95004', '93906', '93905', '95046', '93908', '95020', '95021', '95045', '95024') then 'CANorth_Primary'
when c.zip_5 in ('95536', '95537', '95558', '95564', '95532', '95501', '95538', '95562', '95534', '95540', '95567', '95503', '95545', '95547', '95518', '95502', '95570', '95521', '95548', '95524', '95519', '95565', '95555', '95589', '95531', '95528', '95571', '95542', '95554', '95549', '95560', '95569', '95553', '95525', '95543', '95550', '95420', '95546', '95559', '95456', '95488', '95587', '95460', '95437', '95585', '95410', '95432', '95514', '95573', '95417', '95511', '95526', '95459', '95563', '95427', '95556', '95466', '95463', '95468', '96046', '95454', '95497', '95445', '95527', '96039', '95552', '95415', '95595', '95429', '95568', '95490', '95480', '95412', '95470', '95494', '95421', '96086', '95482', '95418', '96010', '95428', '95450', '95481', '96041', '96031', '95449', '95469', '95430', '96048', '95425', '95486', '94923', '95462', '95465', '95446', '96085', '95471', '95493', '95453', '96037', '95419', '96093', '94922', '96032', '96050', '96076', '94972', '95485', '95436', '95441', '95435', '95472', '96027', '95448', '96024', '95444', '95464', '96052', '95473', '95492', '95451', '94952', '95458', '95401', '95439', '95403', '95407', '96014', '96047', '95443', '95402', '95426', '95406', '96091', '94926', '94927', '94931', '94928', '95405', '96097', '95424', '96034', '95404', '94951', '94955', '94975', '94953', '94999', '95423', '95939', '96074', '95409', '95461', '94515', '96033', '96095', '94954', '95457', '96044', '95422', '96038', '95452', '95467', '96022', '95442', '95431', '96029', '96087', '95979', '95433', '95416', '94576', '96001', '95476', '96094', '94567', '95487', '94508', '94573', '96080', '94574', '94562', '96089', '96099', '96019', '95963', '94599', '96079', '96067', '96025', '96051', '96049', '95679', '94559', '96017', '96064', '96070', '96002', '96007', '94581', '94558', '96003', '95987', '95988', '96021', '95606', '96073', '95913', '95637', '96035', '96078', '95955', '96090', '94534', '95607', '96008', '96062', '95937', '95970', '96055', '95932', '96023', '95943', '96084', '94533', '95627', '95912', '96092', '95694', '95688', '96065', '94519', '95951', '95696', '95653', '96069', '96057', '94521', '94585', '95920', '96011', '94535', '94565', '95698', '95687', '94506', '95625', '96058', '95950', '94517', '95973', '95695', '96088', '94566', '95938', '96059', '96075', '96096', '95926', '94512', '95976', '95927', '95929', '95982', '95620', '95616', '95928', '94509', '95958', '95127', '95697', '94531', '95957', '95148', '94551', '95645', '95948', '95953', '95917', '94571', '95974', '95617', '94513', '95135', '95676', '95993', '95140', '95776', '96013', '94561', '95618', '95969', '95965', '94548', '94514', '94550', '95967', '94511', '95992', '95991', '94505', '95391', '95641', '95837', '95691', '95612', '95659', '95680', '95961', '95968', '95615', '95690', '95954', '95605', '95942', '95831', '95836', '95798', '95799', '95978', '95835', '95834', '95833', '96063', '96016', '95639', '95668', '95674', '95822', '95818', '95832', '96028', '95814', '96071', '95840', '95851', '95852', '95853', '95860', '95865', '95866', '95867', '95894', '95899', '94203', '94204', '94205', '94206', '94207', '94208', '94211', '94229', '94230', '94232', '94234', '94235', '94236', '94237', '94239', '94240', '94244', '94245', '94247', '94248', '94249', '94250', '94252', '94254', '94256', '94257', '94258', '94259', '94261', '94262', '94263', '94267', '94268', '94269', '94271', '94273', '94274', '94277', '94278', '94279', '94280', '94282', '94283', '94284', '94285', '94287', '94288', '94289', '94290', '94291', '94293', '94294', '94295', '94296', '94297', '94298', '94299', '95812', '95813', '95811', '95686', '95816', '96061', '95377', '95376', '95626', '96134', '95901', '95673', '95219', '95817', '95820', '95815', '96040', '95823', '95824', '95838', '95758', '95819', '95757', '95242', '95234', '95378', '93926', '93925', '95966', '95652', '95206', '95828', '95825', '95304', '95692', '95821', '95826', '95660', '95864', '95747', '95914', '95759', '95903', '95843', '95681', '95841', '95209', '95842', '95980', '95916', '95829', '95203', '95608', '95609', '95918', '95972', '95204', '95207', '95827', '95648', '95330', '95258', '95211', '95621', '95210', '95741', '95624', '95915', '96020', '95231', '95267', '95269', '95296', '95297', '95201', '95387', '95655', '95202', '95213', '95919', '95977', '95611', '95678', '95765', '95241', '95830', '95670', '95610', '95205', '95661', '95075', '95940', '95693', '95628', '95363', '95385', '95337', '95962', '95677', '95662', '95632', '95212', '95208', '95360', '95935', '95742', '95253', '95946', '95220', '95941', '96068', '95925', '95336', '95023', '95663', '95763', '95746', '95650', '95923', '95658', '95975', '95240', '95671', '95930', '95630', '95638', '95237', '95215', '95949', '95683', '95366', '95602', '95984', '96009', '95358', '95368', '96137', '96056', '95604', '95960', '95762', '95603', '95664', '95356', '95227', '95722', '95320', '95313', '95236', '96015', '95924', '95971', '95981', '95350', '95956', '95397', '95352', '95353', '95672', '95703', '95614', '95351', '95736', '93635', '96054', '95682', '95354', '95307', '95322', '95254', '95922', '95367', '95355', '95712', '95651', '95640', '95959', '95934', '95328', '95713', '95947', '95319', '95635', '95945', '96006', '95225', '95324', '95357', '95374', '95613', '95669', '95699', '95226', '95380', '95623', '95936', '95326', '95717', '95381', '95382', '95230', '95601', '95910', '95633', '95714', '95252', '95619', '95944', '95986', '96155', '95667', '95685', '95654', '95315', '96108', '95361', '95642', '95334', '95701', '95675', '95983', '95656', '96103', '95228', '96130', '95316', '95303', '96125', '95709', '95634', '95312', '95665', '95386', '96127', '93665', '95631', '95629', '95301', '95715', '95323', '93620', '95689', '93640', '93661', '95232', '95249', '95222', '93622', '95388', '95221', '96132', '96114', '95684', '96106', '96119', '95245', '95348', '95246', '95317', '95248', '96101', '96124', '95636', '95726', '95327', '96116', '95341', '95343', '95344', '95728', '95251', '95247', '95229', '95724', '95257', '95369', '95329', '95309', '95310', '96121', '95370', '96128', '95373', '95340', '96129', '95255', '96122', '95233', '95666', '96117', '96162', '95224', '95365', '95347', '93668', '96136', '95644', '93610', '95325', '95372', '95305', '96141', '96113', '96105', '96135', '95720', '96146', '96126', '95379', '95383', '95333', '96161', '96123', '96160', '93630', '96145', '95223', '96118', '93637', '96142', '95306', '95346', '96109', '96115', '96104', '95735', '96112', '96110', '96140', '95311', '95721', '96151', '96148', '96111', '96143', '93638', '96150', '93606', '95646', '95375', '95345', '95338', '95335', '93653', '96152', '96154', '96157', '96158', '93639', '96156', '93723', '95364', '95321', '93722', '93636', '95318', '93711', '93705', '93728', '96120', '93650', '93704', '93740', '93741', '93701', '93721', '93707', '93708', '93709', '93712', '93714', '93715', '93716', '93717', '93718', '93724', '93729', '93744', '93747', '93750', '93755', '93760', '93761', '93764', '93765', '93771', '93772', '93773', '93774', '93775', '93776', '93777', '93778', '93779', '93786', '93790', '93791', '93792', '93793', '93794', '93844', '93888', '93720', '93703', '93730', '93726', '93710', '93745', '93702', '93601', '93614', '93612', '93613', '93611', '93727', '93645', '93737', '93623', '93626', '93619', '93669', '93604', '93651', '96133', '95389', '93644', '93643', '93602', '96107', '93657', '93667', '93649', '93605', '93634', '93517', '93664', '93642', '93529', '93541', '93546', '93512', '93515', '93514') then 'CANorth_Secondary'
 else 'other' end as portfolio, 

sum(case when g.fund in ('LCV', 'Ed Fund') and g.stagename = 'Received' and closedate >= '01-01-2017' then g.amount else 0 end) as LCVandEF2017,
sum(case when g.fund in ('LCV', 'Ed Fund') and g.stagename = 'Received' and closedate between '01-01-2016' and '12-31-2016'  then g.amount else 0 end) as LCVandEF2016, 
sum(case when g.fund in ('LCV', 'Ed Fund') and g.stagename = 'Received' and closedate between '01-01-2015' and '12-31-2015'  then g.amount else 0 end) as LCVandEF2015, 

sum(case when g.fund = 'LCV' and g.stagename = 'Received' and closedate >= '01-01-2017' then g.amount else 0 end) as LCV2017,
sum(case when g.fund = 'LCV' and g.stagename = 'Received' and closedate between '01-01-2016' and '12-31-2016'  then g.amount else 0 end) as LCV2016, 
sum(case when g.fund = 'LCV' and g.stagename = 'Received' and closedate between '01-01-2015' and '12-31-2015'  then g.amount else 0 end) as LCV2015, 

sum(case when g.fund = 'Ed Fund' and g.stagename = 'Received' and closedate >= '01-01-2017' then g.amount else 0 end) as EF2017,
sum(case when g.fund = 'Ed Fund' and g.stagename = 'Received' and closedate between '01-01-2016' and '12-31-2016'  then g.amount else 0 end) as EF2016, 
sum(case when g.fund = 'Ed Fund' and g.stagename = 'Received' and closedate between '01-01-2015' and '12-31-2015'  then g.amount else 0 end) as EF2015, 

sum(case when g.fund = 'Bundling' and g.stagename = 'Received' and closedate >= '01-01-2017' then g.amount else 0 end) as GG2017,
sum(case when g.fund = 'Bundling' and g.stagename = 'Received' and closedate between '01-01-2016' and '12-31-2016'  then g.amount else 0 end) as GG2016, 
sum(case when g.fund = 'Bundling' and g.stagename = 'Received' and closedate between '01-01-2015' and '12-31-2015'  then g.amount else 0 end) as GG2015


from national.contacts c
join national.allgifts g on g.contactid=c.contactid

where 
---if using for portfolios: deceased = 'f' and
(c.type <> 'Donor Advisor' or c.type is null)
and c.recordtype_hoh = 'Indiv_hoh'
group by c.deceased, c.contactid, c.accountid, c.accountname, c.city, c.state, c.zip_5, c.zip_4, targetscore, targetgiftrange, principalsolution, c.type, c.recordtype_hoh, c.ranking, c.prospectranking, c.relationshipmanager, c.staffcontact, portfolio)
